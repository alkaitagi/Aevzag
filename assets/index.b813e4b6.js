import{c as e,a as t,r as a,w as o,t as n,l as s,s as r,b as i,d as l,e as c,f as u,u as p,g as d,h as m,o as h,i as f,j as v,k as _,m as g,n as y,p as E,v as b,q as w}from"./vendor.c8bf7c27.js";let k;!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const o=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,s)=>{const r=new URL(e,o);if(self[t].moduleMap[r])return a(self[t].moduleMap[r]);const i=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),l=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(i),onerror(){s(new Error(`Failed to import: ${e}`)),n(l)},onload(){a(self[t].moduleMap[r]),n(l)}});document.head.appendChild(l)})),self[t].moduleMap={}}}("/assets/");const j={},O=function(e,t){if(!t)return e();if(void 0===k){const e=document.createElement("link").relList;k=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in j)return;j[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":k,t||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),t?new Promise(((e,t)=>{o.addEventListener("load",e),o.addEventListener("error",t)})):void 0}))).then((()=>e()))},L=[{path:"phonology",name:"phonology",icon:"audiotrack",component:()=>O((()=>__import__("./index.c81e68ab.js")),["/assets/index.c81e68ab.js","/assets/index.19ea6d5c.css","/assets/vendor.c8bf7c27.js","/assets/types.a423ec07.js","/assets/types.c828ff55.css","/assets/TableEntry.6c130267.js","/assets/TableEntry.28ab263e.css","/assets/Flag.66bed960.js","/assets/Flag.57192830.css","/assets/Seeker.7110ab0c.js","/assets/Seeker.e7e6ce0a.css","/assets/index.cbab1530.js","/assets/audio-player.a1bc7c25.js"])},{path:"converter",name:"converter",icon:"sync_alt",component:()=>O((()=>__import__("./index.417d917a.js")),["/assets/index.417d917a.js","/assets/index.e1b1f002.css","/assets/Flag.66bed960.js","/assets/Flag.57192830.css","/assets/vendor.c8bf7c27.js","/assets/file-manager.9a2fdd9a.js"])},{path:"phrasebook",name:"phrasebook",icon:"chat",component:()=>O((()=>__import__("./index.9344e1c8.js")),["/assets/index.9344e1c8.js","/assets/index.09de23dd.css","/assets/types.a423ec07.js","/assets/types.c828ff55.css","/assets/vendor.c8bf7c27.js","/assets/Flag.66bed960.js","/assets/Flag.57192830.css","/assets/Seeker.7110ab0c.js","/assets/Seeker.e7e6ce0a.css","/assets/index.cbab1530.js","/assets/index.4762e9dd.js","/assets/index.0ef8c241.css","/assets/audio-player.a1bc7c25.js"])},{path:"dictionary",name:"dictionary",icon:"book",component:()=>O((()=>__import__("./index.56a964b2.js")),["/assets/index.56a964b2.js","/assets/index.8f68c5d5.css","/assets/Seeker.7110ab0c.js","/assets/Seeker.e7e6ce0a.css","/assets/vendor.c8bf7c27.js","/assets/Flag.66bed960.js","/assets/Flag.57192830.css","/assets/index.cbab1530.js","/assets/search.f060bdbd.js"])}],R=[{path:"phonology",title:"Phonology",name:"phonologyEditor",component:()=>O((()=>__import__("./Editor.a8f55eb2.js")),["/assets/Editor.a8f55eb2.js","/assets/Editor.9c3fef38.css","/assets/EditorCard.02b5a81d.js","/assets/EditorCard.84fe7593.css","/assets/editor.a043aa9b.js","/assets/vendor.c8bf7c27.js","/assets/file-manager.9a2fdd9a.js","/assets/NotesEditor.dd49f81c.js","/assets/TableEntry.6c130267.js","/assets/TableEntry.28ab263e.css"])},{path:"converter",title:"Converter",name:"converterEditor",component:()=>O((()=>__import__("./Editor.76b967fc.js")),["/assets/Editor.76b967fc.js","/assets/Editor.7e321a3a.css","/assets/EditorCard.02b5a81d.js","/assets/EditorCard.84fe7593.css","/assets/editor.a043aa9b.js","/assets/vendor.c8bf7c27.js","/assets/file-manager.9a2fdd9a.js"])},{path:"phrasebook",title:"Phrasebook",name:"phrasebookEditor",component:()=>O((()=>__import__("./Editor.f7cb7df9.js")),["/assets/Editor.f7cb7df9.js","/assets/Editor.6c2a920a.css","/assets/NotesEditor.dd49f81c.js","/assets/EditorCard.02b5a81d.js","/assets/EditorCard.84fe7593.css","/assets/editor.a043aa9b.js","/assets/vendor.c8bf7c27.js","/assets/file-manager.9a2fdd9a.js","/assets/index.4762e9dd.js","/assets/index.0ef8c241.css","/assets/index.cbab1530.js","/assets/Editor.ae4f7374.js","/assets/Editor.b37d8f6a.css"])},{path:"phrasebookÐ¡orpus",title:"Phrasebook Corpus",name:"phrasebookCorpusEditor",component:()=>O((()=>__import__("./CorpusEditor.021a8d56.js")),["/assets/CorpusEditor.021a8d56.js","/assets/CorpusEditor.0268b338.css","/assets/EditorCard.02b5a81d.js","/assets/EditorCard.84fe7593.css","/assets/editor.a043aa9b.js","/assets/vendor.c8bf7c27.js","/assets/file-manager.9a2fdd9a.js","/assets/Editor.ae4f7374.js","/assets/Editor.b37d8f6a.css","/assets/index.4762e9dd.js","/assets/index.0ef8c241.css","/assets/index.cbab1530.js"])},{path:"dictionary",title:"Dictionary",name:"dictionaryEditor",component:()=>O((()=>__import__("./Editor.6721462a.js")),["/assets/Editor.6721462a.js","/assets/Editor.754352ad.css","/assets/editor.a043aa9b.js","/assets/vendor.c8bf7c27.js","/assets/file-manager.9a2fdd9a.js","/assets/Seeker.7110ab0c.js","/assets/Seeker.e7e6ce0a.css","/assets/EditorCard.02b5a81d.js","/assets/EditorCard.84fe7593.css","/assets/NotesEditor.dd49f81c.js","/assets/search.f060bdbd.js"])}],P=[{path:"/home",name:"home",component:()=>O((()=>__import__("./index.49645afe.js")),["/assets/index.49645afe.js","/assets/index.bc0f7e7b.css","/assets/types.a423ec07.js","/assets/types.c828ff55.css","/assets/vendor.c8bf7c27.js","/assets/Flag.66bed960.js","/assets/Flag.57192830.css"])},{path:"/",component:()=>O((()=>__import__("./Navigation.0f5e083f.js")),["/assets/Navigation.0f5e083f.js","/assets/Navigation.a06d9b94.css","/assets/vendor.c8bf7c27.js"]),children:L},{path:"/editor/",component:()=>O((()=>__import__("./EditorNavigation.dffb2fb3.js")),["/assets/EditorNavigation.dffb2fb3.js","/assets/EditorNavigation.bc2fd678.css","/assets/editor.a043aa9b.js","/assets/vendor.c8bf7c27.js","/assets/file-manager.9a2fdd9a.js"]),children:R},{path:"/:pathMatch(.*)",redirect:{name:"home"}}];var I=e({history:t(),routes:P});class V{constructor(e,t="cache",s){this.storage=e,this.records=a({}),e.getItem(t).then((a=>{a&&(this.records.value=a),o(this.records,(()=>e.setItem(t,n(this.records.value))),{deep:!0}),null==s||s()}))}clean(){this.records.value={}}add(e){return!this.records.value[e]&&!!this.update(e)}delete(e){delete this.records.value[e]}update(e){return this.records.value[e]=Date.now()}updateOf(e){var t;return null!=(t=this.records.value[e])?t:0}}const x=a([]),A="https://raw.githubusercontent.com/alkaitagi/avzag/store/",D=s.createInstance({name:"user"}),C=new V(D,"cache",(()=>D.getItem("lects").then((e=>x.value=null!=e?e:["Kaitag"])).then((()=>T(!0)))));async function T(e=!1){const t=Object.entries(C.records.value).filter((([e])=>!e.includes("/")||x.value.some((t=>e.startsWith(t))))),a=[];for(const[o,n]of t){const e=await fetch("https://europe-west1-avzag-languages.cloudfunctions.net/lastCommit?"+new URLSearchParams({path:o})).then((e=>e.text())).then((e=>Number(e)));Date.now()-3e5>e&&e>n&&a.push(o)}a.length&&(console.log("cleaning outdated cache",a),e&&Object.keys(C.records.value).length&&window.alert("New data is available, reloading..."),null==a||a.forEach((e=>C.delete(e))),location.reload())}async function S(e,t){if(e.endsWith(".json")||(e+=".json"),!C.add(e))return await D.getItem(e);console.log("cached",e);const a=await fetch(A+e,{cache:"no-store"}).then((e=>e.json())).then((e=>e)).catch((()=>t));return await D.setItem(e,a),a}async function U(e){const t={};for(const a of x.value){const o=await S(a+"/"+e);o&&(t[a]=o)}return t}let M;const $=r([]),N=r(),B=a([]);function W(e){let t="";for(const{ipa:a,tags:o}of M.primary)if(e.includes(a)){t+=o;break}for(const{ipa:a,tags:o}of M.secondary)e.includes(a)&&(t+=" "+o);return t}function q(e){let t="",a=0;return" "===e.charAt(0)&&(t=" ",a=1),t+e.charAt(a).toUpperCase()+e.slice(a+1)}function z(e,t){e=" "+e.replace(/\n/g,"\n ").trim();let a="";for(let o=0;o<e.length;){let n=!1;for(const[s,r]of t){if(!s||!r)continue;const t=s.length,i=e.substring(o,o+t),l=[[s,r],[q(s),q(r)],[s.toUpperCase(),r.toUpperCase()]];for(const[e,s]of l)if(i===e){n=!0,a+=s,o+=t;break}if(n)break}n||(a+=e[o],o++)}return a.replace(/\n /g,"\n").trim()}o(x,(async()=>{$.value.length=0,B.value.length=0,M=await S("ipa");const e=await U("phonology");B.value=Object.keys(e),function(e){const t={};for(const a in e){const o=e[a];o&&o.forEach((e=>{const o=e.phoneme;o in t||(t[o]={ipa:o,tags:W(o),lects:{}}),t[o].lects[a]=e}))}$.value=Object.values(t),$.value.sort((({ipa:e},{ipa:t})=>e>t?1:t>e?-1:0)),N.value=$.value[0]}(e)}));const F=r({});o(x,(async()=>{F.value={},F.value=await U("converter")}));const K=r();o(F,(e=>{e&&(K.value=Object.values(e)[0])}));const G=i({});o(K,(e=>{e&&(G.initial=e.mappings[0],G.final=e.mappings[1],J.initial="")}));const H=l((()=>{var e,t,a,o;return{initial:null!=(t=null==(e=G.initial)?void 0:e.pairs)?t:[],final:null!=(o=null==(a=G.final)?void 0:a.pairs.map((([e,t])=>[t,e])))?o:[]}}));o((()=>H.value.initial),((e,t)=>{J.initial=z(z(J.initial,t),e.map((([e,t])=>[t,e])))}));const J=i({initial:"",final:l((()=>z(z(J.initial,H.value.initial),H.value.final)))}),Q=r([]),X=r({}),Y=r(),Z=r(),ee=a([]);function te(e){return e.flatMap((e=>e.map((e=>e.text.plain.replaceAll("*","")))))}o(x,(async()=>{Q.value=[],X.value={},Q.value=await S("phrasebookCorpus",[]),X.value=await U("phrasebook"),function(){if(!X.value)return;const e=Object.values(X.value);ee.value=Q.value.map((({phrases:t})=>t.map((({id:t,name:a,blocks:o})=>[a,...te(o),...e.flatMap((e=>{var a,o;return te(null!=(o=null==(a=e[t])?void 0:a.blocks)?o:[])}))].join(" ").toLowerCase()))))}(),Y.value=Q.value[0],Z.value=Y.value.phrases[0]}));const ae=r({lists:[]}),oe=r({});o(x,(async()=>{oe.value={},oe.value=await U("dictionary"),ae.value=await S("dictionaryMeta")}));var ne=c({setup(){const e=p(),t=d();e.name&&"home"!==e.name||t.push(localStorage.url&&localStorage.url!==e.path?{path:localStorage.url}:{name:"home"}),u((()=>{const t=e.name;t&&(localStorage.url=e.path,["phonology","converter","phrasebook","dictionary"].includes(t)&&(localStorage.urlUser=e.path))}))}});ne.render=function(e,t,a,o,n,s){const r=f("router-view");return h(),m(r)};var se=c({props:{icon:{type:String,default:""},text:{type:String,default:""},isOn:Boolean}});const re={key:0,class:"icon"},ie={key:1};se.render=function(e,t,a,o,n,s){return h(),m("button",{class:{highlight:e.isOn}},[e.icon?(h(),m("p",re,v(e.icon),1)):_("",!0),e.text?(h(),m("p",ie,v(e.text),1)):_("",!0),g(e.$slots,"default")],2)};var le=c({props:{modelValue:Boolean,icon:{type:String,default:""},text:{type:String,default:""}},emits:["update:modelValue"],setup:(e,{emit:t,attrs:a})=>({toggle:function(){t("update:modelValue",!e.modelValue)},attrs:a})});le.render=function(e,t,a,o,n,s){const r=se;return h(),m("div",{onClick:t[1]||(t[1]=(...t)=>e.toggle&&e.toggle(...t))},[g(e.$slots,"default",{on:e.modelValue},(()=>[y(r,E({style:{width:"100%"}},e.attrs,{icon:e.icon,text:e.text,"is-on":e.modelValue}),null,16,["icon","text","is-on"])]))])},function(e={}){const{immediate:t=!1,onNeedRefresh:a,onOfflineReady:o}=e;let n;"serviceWorker"in navigator&&(n=new b("/sw.js",{scope:"/"}),n.addEventListener("activated",(e=>{e.isUpdate?window.location.reload():null==o||o()})),n.register({immediate:t}).then((e=>e)))}();const ce=w(ne);ce.component("Btn",se),ce.component("Toggle",le),ce.use(I),I.isReady().then((()=>ce.mount("#app")));export{V as S,le as _,T as a,S as b,C as c,se as d,R as e,N as f,B as g,F as h,K as i,H as j,z as k,x as l,G as m,Z as n,Y as o,$ as p,Q as q,A as r,D as s,J as t,L as u,ee as v,X as w,oe as x,ae as y};
